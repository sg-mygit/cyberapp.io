<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/7.2.96/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0d1117;
            color: #e6edf3;
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            padding: 15px;
            min-height: 100vh;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        body.light-mode {
            background: #ffffff;
            color: #24292f;
        }

        .container {
            max-width: 1920px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 15px;
        }

        h1 {
            color: #fff;
            margin-bottom: 12px;
            font-size: 2.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        body.light-mode h1 {
            color: #24292f;
        }

        .theme-toggle {
            padding: 8px;
            background: #21262d;
            border: 1px solid #30363d;
            border-radius: 6px;
            color: #e6edf3;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: #30363d;
            border-color: #58a6ff;
        }

        body.light-mode .theme-toggle {
            background: #f6f8fa;
            border-color: #d0d7de;
            color: #24292f;
        }

        body.light-mode .theme-toggle:hover {
            background: #e7eaed;
            border-color: #0969da;
        }

        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 12px;
        }

        .search-box {
            flex: 1;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 8px 40px 8px 40px;
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 6px;
            color: #e6edf3;
            font-size: 15px;
            font-family: 'Segoe UI', 'Roboto', sans-serif;
            transition: all 0.3s ease;
        }

        body.light-mode .search-box input {
            background: #f6f8fa;
            border-color: #d0d7de;
            color: #24292f;
        }

        .search-box input:focus {
            outline: none;
            border-color: #58a6ff;
            box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.1);
        }

        .search-box .mdi {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #7d8590;
            font-size: 16px;
        }

        .search-box .clear-search {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #7d8590;
            cursor: pointer;
            font-size: 16px;
            padding: 4px;
            display: none;
        }

        .search-box .clear-search:hover {
            color: #e6edf3;
        }

        .expand-collapse-btns {
            display: flex;
            gap: 10px;
        }

        .expand-btn, .collapse-btn {
            padding: 8px 14px;
            background: #21262d;
            border: 1px solid #30363d;
            border-radius: 6px;
            color: #e6edf3;
            cursor: pointer;
            font-size: 14px;
            font-family: 'Segoe UI', 'Roboto', sans-serif;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
        }

        .expand-btn:hover, .collapse-btn:hover {
            background: #30363d;
            border-color: #58a6ff;
        }

        body.light-mode .expand-btn,
        body.light-mode .collapse-btn {
            background: #f6f8fa;
            border-color: #d0d7de;
            color: #24292f;
        }

        body.light-mode .expand-btn:hover,
        body.light-mode .collapse-btn:hover {
            background: #e7eaed;
            border-color: #0969da;
        }

        .checklist {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .category-section {
            margin-bottom: 8px;
        }

        .category-section .category-header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            border-radius: 6px;
            margin-bottom: 5px;
            border: 2px solid;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .category-section .category-header:hover {
            opacity: 0.8;
        }

        .subcategory-section {
            margin-left: 20px;
            margin-bottom: 6px;
        }

        .category-section.collapsed > .subcategory-section {
            display: none;
        }

        .subcategory-section.collapsed > .check-item {
            display: none;
        }
        
        .category-header:after, .subcategory-header:after {
            content: "\F0140";
            font-family: "Material Design Icons";
            margin-left: auto;
            transition: transform 0.3s ease;
        }

        .category-section.collapsed > .category-header:after {
            transform: rotate(-90deg);
        }

        .subcategory-section.collapsed > .subcategory-header:after {
            transform: rotate(-90deg);
        }

        .subcategory-section .subcategory-header {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 6px;
            margin-bottom: 4px;
            border: 1px solid;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .subcategory-section .subcategory-header:hover { 
            opacity: 0.9;
        }

        .check-item {
            margin-left: 40px;
            margin-bottom: 2px;
            border-radius: 6px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid #21262d;
        }

        .check-item.hidden {
            display: none;
        }

        .check-header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: #161b22;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .check-header:hover {
            background: #1c2128;
            border-left: 2px solid #58a6ff;
            padding-left: 10px;
        }

        .check-header.expanded {
            background: #1c2128;
            border-bottom: 1px solid #30363d;
        }

        body.light-mode .check-header {
            background: #f6f8fa;
        }

        body.light-mode .check-header:hover {
            background: #e7eaed;
            border-left-color: #0969da;
        }

        body.light-mode .check-header.expanded {
            background: #e7eaed;
            border-bottom-color: #d0d7de;
        }

        .check-number {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            color: #7d8590;
            font-size: 13px;
            font-weight: bold;
            min-width: 50px;
            font-style: normal;
        }

        body.light-mode .check-number {
            color: #57606a;
        }

        .check-icon {
            font-size: 18px;
        }

        .check-title {
            flex: 1;
            font-size: 15px;
            font-weight: 500;
            font-style: normal;
        }

        .check-checkbox {
            display: flex;
            align-items: center;
        }

        .check-checkbox input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
            accent-color: #238636;
        }

        .check-desc {
            padding: 10px 12px;
            background: #0d1117;
            border-top: 1px solid #30363d;
            display: none;
            animation: slideDown 0.3s ease;
            line-height: 1.5;
            font-size: 14px;
            font-style: normal;
        }

        .check-desc.visible {
            display: block;
        }

        body.light-mode .check-desc {
            background: #ffffff;
            border-top-color: #d0d7de;
        }

        /* Markdown styling */
        .desc-content {
            font-style: normal;
        }

        .desc-content h1 {
            font-size: 1.4em;
            margin-top: 0.3em;
            margin-bottom: 0.3em;
            color: #58a6ff;
            border-bottom: 1px solid #30363d;
            padding-bottom: 0.2em;
            font-style: normal;
        }

        .desc-content h2 {
            font-size: 1.2em;
            margin-top: 0.3em;
            margin-bottom: 0.3em;
            color: #58a6ff;
            font-style: normal;
        }

        .desc-content h3 {
            font-size: 1.05em;
            margin-top: 0.3em;
            margin-bottom: 0.3em;
            color: #7d8590;
            font-style: normal;
        }

        .desc-content p {
            margin-bottom: 0.5em;
            font-style: normal;
        }

        .desc-content ul, .desc-content ol {
            margin-left: 1.2em;
            margin-bottom: 0.5em;
        }

        .desc-content li {
            margin-bottom: 0.2em;
            font-style: normal;
        }

        .desc-content code {
            background: #161b22;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.95em;
            color: #e6edf3;
            font-style: normal;
        }

        .desc-content pre {
            background: #161b22;
            padding: 12px;
            border-radius: 4px;
            overflow-x: auto;
            margin-bottom: 0.5em;
        }

        .desc-content pre code {
            background: none;
            padding: 0;
        }

        /* Override highlight.js theme for light mode */
        body.light-mode .desc-content pre {
            background: #f6f8fa;
        }

        body.light-mode .desc-content code {
            background: #f6f8fa;
        }

        /* Custom syntax highlighting colors */
        .desc-content .hljs-comment {
            color: #2d7a3e !important;
            font-style: italic;
        }

        body.light-mode .desc-content .hljs-comment {
            color: #1a6b2e !important;
        }

        .desc-content a {
            color: #58a6ff;
            text-decoration: none;
            font-style: normal;
        }

        .desc-content a:hover {
            text-decoration: underline;
        }

        .desc-content blockquote {
            border-left: 2px solid #30363d;
            padding-left: 0.8em;
            margin-left: 0;
            color: #7d8590;
            font-style: italic;
        }

        .desc-content strong {
            color: #fff;
            font-weight: 600;
            font-style: normal;
        }

        body.light-mode .desc-content strong {
            color: #24292f;
        }

        body.light-mode .desc-content h1,
        body.light-mode .desc-content h2 {
            color: #0969da;
        }

        body.light-mode .desc-content h3,
        body.light-mode .desc-content blockquote {
            color: #57606a;
        }

        body.light-mode .desc-content code,
        body.light-mode .desc-content pre {
            background: #f6f8fa;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .highlight {
            background: #9e6a03;
            color: #fff;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #7d8590;
            font-size: 16px;
            display: none;
        }

        .no-results.visible {
            display: block;
        }

        /* Print styles */
        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                color-adjust: exact !important;
            }

            body {
                background: white !important;
                color: black !important;
                padding: 10px;
            }

            header {
                page-break-after: avoid;
                margin-bottom: 10px;
            }

            h1 {
                page-break-after: avoid;
                color: black !important;
            }

            .controls,
            .no-results,
            .theme-toggle {
                display: none !important;
            }

            .category-section {
                page-break-inside: avoid;
                page-break-after: avoid;
            }

            .category-header {
                background: #e8e8e8 !important;
                color: black !important;
                border-color: #cccccc !important;
                page-break-after: avoid;
            }

            .category-header i {
                color: black !important;
            }

            .subcategory-section {
                page-break-inside: avoid;
            }

            .subcategory-header {
                background: #f0f0f0 !important;
                color: black !important;
                border-color: #dddddd !important;
            }

            .subcategory-header i {
                color: black !important;
            }

            .check-item {
                page-break-inside: avoid;
                border: 1px solid #ddd !important;
                margin-bottom: 5px;
                background: white !important;
            }

            .check-header {
                background: #f8f8f8 !important;
                color: black !important;
                padding: 8px 12px;
            }

            .check-header i {
                color: #666666 !important;
            }

            .check-number {
                color: #666666 !important;
            }

            .check-desc {
                background: white !important;
                color: black !important;
                display: block !important;
                border-top-color: #dddddd !important;
            }

            .desc-content * {
                color: black !important;
            }

            .desc-content h1,
            .desc-content h2,
            .desc-content h3 {
                color: black !important;
            }

            .desc-content code,
            .desc-content pre {
                background: #f5f5f5 !important;
                color: black !important;
                border: 1px solid #dddddd;
            }

            .category-header:after,
            .subcategory-header:after {
                display: none;
            }

            .check-checkbox input[type="checkbox"] {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>
                üõ°Ô∏è Cybersecurity Checklist
                <button class="theme-toggle" id="themeToggle" title="Toggle light/dark mode">
                    <i class="mdi mdi-weather-sunny"></i>
                </button>
            </h1>
            <div class="controls">
                <div class="search-box">
                    <i class="mdi mdi-magnify"></i>
                    <input type="text" id="searchInput" placeholder="Search checks or descriptions...">
                    <button class="clear-search" id="clearSearch">
                        <i class="mdi mdi-close-circle"></i>
                    </button>
                </div>
                <div class="expand-collapse-btns">
                    <button class="expand-btn" id="expandAll">
                        <i class="mdi mdi-chevron-down"></i>
                        <span>Expand All</span>
                    </button>
                    <button class="collapse-btn" id="collapseAll">
                        <i class="mdi mdi-chevron-right"></i>
                        <span>Collapse All</span>
                    </button>
                </div>
            </div>
        </header>

        <div class="checklist" id="checklist"></div>
        <div class="no-results" id="noResults">
            <i class="mdi mdi-magnify-close" style="font-size: 48px; display: block; margin-bottom: 10px;"></i>
            No results found
        </div>
    </div>

    <script>
        let checksData = [];

        // Configure marked options
        marked.setOptions({
            breaks: true,
            gfm: true,
            headerIds: false,
            mangle: false
        });

        async function loadYAML() {
            try {
                const response = await fetch('checks.yaml');
                if (!response.ok) {
                    throw new Error('Could not load checks.yaml');
                }
                const yamlText = await response.text();
                const data = jsyaml.load(yamlText);
                processData(data);
                renderChecklist();
            } catch (error) {
                console.error('Error loading YAML:', error);
                document.getElementById('checklist').innerHTML = '<p style="color: #f85149;">Error loading checks.yaml file. Make sure the file is in the same directory as this HTML file.</p>';
            }
        }

        function processData(data) {
            let categoryNumber = 1;

            for (const [catKey, catValue] of Object.entries(data)) {
                let subNumber = 1;
                
                for (const [subKey, subValue] of Object.entries(catValue)) {
                    if (subKey === 'text' || subKey === 'txtcolor' || subKey === 'bgcolor' || subKey === 'subtxtcolor' || subKey === 'subbgcolor' || subKey === 'icon') continue;
                    
                    let linkNumber = 1;
                    
                    for (const [linkKey, linkValue] of Object.entries(subValue)) {
                        if (linkKey === 'text' || linkKey === 'icon') continue;
                        
                        checksData.push({
                            number: `${categoryNumber}.${String(subNumber).padStart(2, '0')}.${String(linkNumber).padStart(2, '0')}`,
                            category: catKey,
                            categoryText: catValue.text || catKey,
                            categoryIcon: catValue.icon || 'mdi-folder',
                            categoryTxtColor: catValue.txtcolor || '#9CCBFF',
                            categoryBgColor: catValue.bgcolor || '#161b22',
                            subcategory: subKey,
                            subcategoryText: subValue.text || subKey,
                            subcategoryIcon: subValue.icon || 'mdi-folder-outline',
                            subcategoryTxtColor: catValue.subtxtcolor || '#4C90DA',
                            subcategoryBgColor: catValue.subbgcolor || '#0d1117',
                            icon: linkValue.icon || 'mdi-link',
                            title: linkValue.title || linkKey,
                            desc: linkValue.desc || ''
                        });
                        
                        linkNumber++;
                    }
                    subNumber++;
                }
                categoryNumber++;
            }
        }

        function renderChecklist() {
            const container = document.getElementById('checklist');
            let html = '';
            let currentCategory = '';
            let currentSubcategory = '';

            checksData.forEach((check, index) => {
                if (check.category !== currentCategory) {
                    if (currentSubcategory) html += '</div>';
                    if (currentCategory) html += '</div>';
                    
                    console.log('Category colors:', check.categoryText, check.categoryTxtColor, check.categoryBgColor);
                    
                    html += `
                        <div class="category-section" data-category="${check.category}">
                            <div class="category-header" style="color: ${check.categoryTxtColor} !important; background: ${check.categoryBgColor} !important; border-color: ${check.categoryTxtColor} !important;">
                                <i class="mdi ${check.categoryIcon}" style="color: ${check.categoryTxtColor} !important;"></i>
                                <span>${check.categoryText}</span>
                            </div>
                    `;
                    currentCategory = check.category;
                    currentSubcategory = '';
                }

                if (check.subcategory !== currentSubcategory) {
                    if (currentSubcategory) html += '</div>';
                    
                    console.log('Subcategory colors:', check.subcategoryText, check.subcategoryTxtColor, check.subcategoryBgColor);
                    
                    html += `
                        <div class="subcategory-section collapsed" data-subcategory="${check.subcategory}">
                            <div class="subcategory-header" style="color: ${check.subcategoryTxtColor} !important; background: ${check.subcategoryBgColor} !important; border-color: ${check.subcategoryTxtColor} !important;">
                                <i class="mdi ${check.subcategoryIcon}" style="color: ${check.subcategoryTxtColor} !important;"></i>
                                <span>${check.subcategoryText}</span>
                            </div>
                    `;
                    currentSubcategory = check.subcategory;
                }

                html += `
                    <div class="check-item" data-id="${index}">
                        <div class="check-header">
                            <span class="check-number">${check.number}</span>
                            <i class="mdi ${check.icon} check-icon" style="color: #7d8590;"></i>
                            <span class="check-title">${check.title}</span>
                            <div class="check-checkbox">
                                <input type="checkbox" onclick="event.stopPropagation()" data-check-id="${index}">
                            </div>
                        </div>
                        <div class="check-desc">
                            <div class="desc-content"></div>
                        </div>
                    </div>
                `;
            });

            if (currentSubcategory) html += '</div>';
            if (currentCategory) html += '</div>';

            container.innerHTML = html;

            document.querySelectorAll('.check-header').forEach(header => {
                header.addEventListener('click', (e) => {
                    if (e.target.type === 'checkbox') return;
                    
                    const item = header.parentElement;
                    const desc = item.querySelector('.check-desc');
                    const descContent = item.querySelector('.desc-content');
                    const id = parseInt(item.dataset.id);
                    const check = checksData[id];
                    
                    if (descContent && !descContent.dataset.rendered) {
                        // Clean up the description text
                        let descText = check.desc || '';
                        
                        console.log('Original desc:', descText);
                        
                        // Parse markdown
                        const htmlContent = marked.parse(descText);
                        descContent.innerHTML = htmlContent;
                        
                        console.log('Rendered HTML:', htmlContent);
                        console.log('Code blocks found:', descContent.querySelectorAll('pre code').length);
                        
                        descContent.dataset.rendered = 'true';
                        
                        // Apply syntax highlighting to ALL code blocks
                        setTimeout(() => {
                            descContent.querySelectorAll('pre code').forEach((block) => {
                                console.log('Highlighting block:', block.className, block.textContent.substring(0, 50));
                                hljs.highlightElement(block);
                            });
                        }, 10);
                    }
                    
                    desc.classList.toggle('visible');
                    header.classList.toggle('expanded');
                });
            });

            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                const checkId = checkbox.dataset.checkId;
                const saved = localStorage.getItem(`check-${checkId}`);
                if (saved === 'true') {
                    checkbox.checked = true;
                }
                
                checkbox.addEventListener('change', (e) => {
                    localStorage.setItem(`check-${checkId}`, e.target.checked);
                });
            });

            document.querySelectorAll('.category-header').forEach(header => {
                header.addEventListener('click', (e) => {
                    const section = header.parentElement;
                    section.classList.toggle('collapsed');
                });
            });

            document.querySelectorAll('.subcategory-header').forEach(header => {
                header.addEventListener('click', (e) => {
                    const section = header.parentElement;
                    section.classList.toggle('collapsed');
                });
            });
            
            document.querySelectorAll('.category-section').forEach(section => {
                section.classList.remove('collapsed');
            });
            document.querySelectorAll('.subcategory-section').forEach(section => {
                section.classList.add('collapsed');
            });
        }

        function filterChecklist() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const items = document.querySelectorAll('.check-item');
            let visibleCount = 0;
            
            const categoriesToExpand = new Set();
            const subcategoriesToExpand = new Set();

            items.forEach(item => {
                const id = parseInt(item.dataset.id);
                const check = checksData[id];
                
                const matchesSearch = !searchTerm || 
                    check.title.toLowerCase().includes(searchTerm) ||
                    check.desc.toLowerCase().includes(searchTerm) ||
                    check.categoryText.toLowerCase().includes(searchTerm) ||
                    check.subcategoryText.toLowerCase().includes(searchTerm);

                if (matchesSearch) {
                    item.classList.remove('hidden');
                    visibleCount++;
                    highlightText(item, searchTerm);
                    
                    const subcategorySection = item.closest('.subcategory-section');
                    const categorySection = item.closest('.category-section');

                    if (subcategorySection) {
                        subcategoriesToExpand.add(subcategorySection);
                    }
                    if (categorySection) {
                        categoriesToExpand.add(categorySection);
                    }
                } else {
                    item.classList.add('hidden');
                    const desc = item.querySelector('.check-desc');
                    const header = item.querySelector('.check-header');
                    if (desc) desc.classList.remove('visible');
                    if (header) header.classList.remove('expanded');
                }
            });

            document.querySelectorAll('.category-section').forEach(section => {
                if (searchTerm) {
                    section.classList.toggle('collapsed', !categoriesToExpand.has(section));
                } else {
                    section.classList.remove('collapsed');
                }
            });
            
            document.querySelectorAll('.subcategory-section').forEach(section => {
                section.classList.toggle('collapsed', !subcategoriesToExpand.has(section));
            });

            document.getElementById('noResults').classList.toggle('visible', visibleCount === 0);
            document.getElementById('clearSearch').style.display = searchTerm ? 'block' : 'none';
        }

        function highlightText(element, searchTerm) {
            if (!searchTerm) return;

            const title = element.querySelector('.check-title');
            const descContent = element.querySelector('.desc-content');

            [title, descContent].forEach(el => {
                if (!el) return;
                const originalText = el.textContent;
                const regex = new RegExp(`(${searchTerm})`, 'gi');
                el.innerHTML = originalText.replace(regex, '<span class="highlight">$1</span>');
            });
        }

        document.getElementById('searchInput').addEventListener('input', filterChecklist);

        document.getElementById('clearSearch').addEventListener('click', () => {
            document.getElementById('searchInput').value = '';
            filterChecklist(); 
        });

        document.getElementById('expandAll').addEventListener('click', () => {
            document.querySelectorAll('.category-section').forEach(section => {
                section.classList.remove('collapsed');
            });

            document.querySelectorAll('.subcategory-section').forEach(section => {
                section.classList.remove('collapsed');
            });

            document.querySelectorAll('.check-item:not(.hidden) .check-desc').forEach(desc => {
                const descContent = desc.querySelector('.desc-content');
                const item = desc.closest('.check-item');
                const id = parseInt(item.dataset.id);
                const check = checksData[id];
                
                if (descContent && !descContent.dataset.rendered) {
                    const htmlContent = marked.parse(check.desc || '');
                    descContent.innerHTML = htmlContent;
                    descContent.dataset.rendered = 'true';
                    
                    // Apply syntax highlighting to code blocks
                    setTimeout(() => {
                        descContent.querySelectorAll('pre code').forEach((block) => {
                            hljs.highlightElement(block);
                        });
                    }, 10);
                }
                
                desc.classList.add('visible');
                desc.previousElementSibling.classList.add('expanded');
            });
        });

        document.getElementById('collapseAll').addEventListener('click', () => {
            document.querySelectorAll('.category-section').forEach(section => {
                section.classList.add('collapsed');
            });

            document.querySelectorAll('.subcategory-section').forEach(section => {
                section.classList.add('collapsed');
            });

            document.querySelectorAll('.check-desc').forEach(desc => {
                desc.classList.remove('visible');
                desc.previousElementSibling.classList.remove('expanded');
            });
        });

        document.getElementById('themeToggle').addEventListener('click', () => {
            document.body.classList.toggle('light-mode');
            const icon = document.querySelector('#themeToggle i');
            if (document.body.classList.contains('light-mode')) {
                icon.className = 'mdi mdi-weather-night';
                localStorage.setItem('theme', 'light');
            } else {
                icon.className = 'mdi mdi-weather-sunny';
                localStorage.setItem('theme', 'dark');
            }
        });

        if (localStorage.getItem('theme') === 'light') {
            document.body.classList.add('light-mode');
            document.querySelector('#themeToggle i').className = 'mdi mdi-weather-night';
        }

        loadYAML();
    </script>
</body>
</html>
